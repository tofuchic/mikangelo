# 実験概要

- 何種類かの蜜柑を[brownie](https://github.com/ksasao/brownie)で見分けることができるかを検証する

## 前提

- 背景は extract する
- カメラ（M5StickV）と被写体の距離は一定

## 実験の観点

- 学習用に使う写真
  - 蜜柑の角度
    - 上面（へたが見える角度）
    - 側面
    - 下面

---

# 実験に使う蜜柑の種類

- 柑味から送られてきた 2021 年 4 月分の柑橘、計 7 種類（品種名/ラベル名）
  1. 南津海/natsumi
  1. 弓削ひょう柑/yuge
  1. 湘南ゴールド/shonan
  1. さつき八朔/satsuki
  1. レモネード/lemonade
  1. スターライトネーブル/starlight
  1. なったん/nattan

# データセット

- 通常の機械学習であれば学習用データ・検証用データ・テスト用データの 3 つを用意するが、柑味から届くみかんは品種毎に 2~3 個のため、学習用みかんとテスト用みかんのみ用意した

---

# 実験方法

## 上面（へたが見える角度）のみ学習させた場合

## 上面、側面、下面を学習させた場合

1. 学習用みかんを使い、学習は各ケース一回ずつ行う

   - 「弓削ひょう柑だけ側面を何回か学習させる」などはしない
   - 7 品種 x 3 パターンで合計 21 回撮影

1. テスト用みかんの品種ごとに、上面・側面・下面が写るように無作為に配置し、判定される結果を読み取る

# 実験結果

## 凡例

- 〇 : 定常的に正しいラベルが表示された
- △ : 正しいラベルを含む複数のラベルで連続的に切り替わった
- × : 正しいラベルを含まない複数のラベルで連続的に切り替わった
- ×× : 定常的に誤ったラベルが表示された
- \- : ラベル判定なし

## 上面（へたが見える角度）のみ学習させた場合

- 試行回数 1 回

  |     | natsumi |     yuge      | shonan | satsuki | lemonade | starlight | nattan |
  | :-- | :-----: | :-----------: | :----: | :-----: | :------: | :-------: | :----: |
  | top |    ○    | △（lemonade） |   ○    |    ○    |    ○     |     ○     |   ○    |

## 上面、側面、下面を学習させた場合

- 試行回数 3 回

  - 1 回目

    |        |    natsumi     |           yuge           |     shonan     |   satsuki   |   lemonade    |   starlight   |     nattan     |
    | :----- | :------------: | :----------------------: | :------------: | :---------: | :-----------: | :-----------: | :------------: |
    | top    |       ○        |     ××（starlight）      |       ○        |      ○      |       ○       |       ○       | △（starlight） |
    | side   |       ○        | △（lemonade、starlight） |       ○        | △（nattan） | ××（natsumi） | ××（satsuki） |  △（satsuki）  |
    | bottom | ××（lemonade） |      △（lemonade）       | ××（lemonade） | △（nattan） |       ○       |       ○       |       ○        |

  - 2 回目

    |        | natsumi |           yuge           |     shonan     | satsuki |   lemonade    |   starlight   |     nattan      |
    | :----- | :-----: | :----------------------: | :------------: | :-----: | :-----------: | :-----------: | :-------------: |
    | top    |    ○    |      △（starlight）      |       ○        |    ○    |       ○       |       ○       | ××（starlight） |
    | side   |    ○    |      ××（lemonade）      | △（lemonade）  |    ○    | ××（natsumi） | ××（satsuki） |        ○        |
    | bottom |    ○    | ×（lemonade、starlight） | ××（lemonade） |    ○    |       ○       |       ○       |  △（satsuki）   |

  - 3 回目

    |        | natsumi |          yuge          |     shonan     |   satsuki   |   lemonade    |   starlight   |     nattan      |
    | :----- | :-----: | :--------------------: | :------------: | :---------: | :-----------: | :-----------: | :-------------: |
    | top    |    ○    |           ○            |       ○        | △（nattan） |       ○       |       ○       | ××（starlight） |
    | side   |    ○    |     ××（lemonade）     |       ○        |      ○      | ××（natsumi） | ××（satsuki） |        ○        |
    | bottom |    ○    | ×（lemonade、natsumi） | ××（lemonade） | △（nattan） |       ○       |       ○       |  △（satsuki）   |

# 考察

- 弓削ひょう柑の判定が難しかったが、人間が見れば分かりそう
  - M5StickC のカメラのピクセル数が柑橘の表面の細かい模様を捉え切れていない？
  - 柑橘の大きさは学習できていない？
- 上面を写しての判定は、他の面を学習したことで精度が落ちている
  - 精度向上のアプローチとしては、各品種に対して学習する面を増やすのではなく、上面に限って学習用に撮影する枚数を増やすという考えもある
- 部位（上面・側面・下面）ごとの判定結果を総合すれば一意に特定できそう
  - たとえば弓削ひょう柑を判定させた結果を見ると、スターライトネーブル・レモネード・南津海と誤って判定されがちであるが、そのパターンも含めて弓削ひょう柑の性質と考えれば、総合的に弓削ひょう柑であると判断できそう
    - 上面がスターライトネーブル、側面がレモネード、下面が南津海と判定されるような柑橘があったとしたら、弓削ひょう柑である確率が高い

# 課題

AI エッジカメラを農業で活躍させるには以下の要素が必要ではないだろうか

- ハード
  - エッジデバイスに搭載できるほど小型・安価で
    - 皮の模様が分かる程度に高画素なカメラ
    - 被写体との距離が分かるデプスカメラ
- ソフト
  - 物体認識をして、被写体のラベルがアップデートされる機械学習手法
  - ラベルの親子関係が表現できる機械学習手法
